<style>
	.truncate {
	    width: 150px;
	    white-space: nowrap;
	    overflow: hidden;
	    text-overflow: ellipsis;
	    display: inline-block;
	    text-decoration: none;
	}
	a:focus, a:hover {
	    color: #23527C;
	    text-decoration: none;
	}
</style>
<script type="text/javascript">
    
	$.get( serverURL + "users/" + userId + "/currSection", function( data ) {

		sid = data['currentSection'];
		asid = data['activeSection'];
		
		/* $.get( serverURL + "sections", function( data ) {
			my(data, sid, asid);
		}); */
		
		var unlockarray = [];
		$.when(A(),B()).done(function(data1,data2){
		
			var section = data1[0];
			var unlockarray = JSON.parse("[" + data2[0] + "]");
			my(section,sid, asid,unlockarray);
		
			
		})
	});

	$.get( serverURL + "sections/optional", function( data ) {
		my2(data);
	});	
	
	function A(){
		
		return $.get( serverURL + "sections", function( data ) {
			
			
		});
	}

	
	$.get( serverURL + "sections/optional", function( data ) {
		my2(data);
		
	});	
	
	function B(){
		
		return  $.ajax({
			 
			 type: "GET",
			  url: serverURL + "users/getlocksection?userId="+ userId,
			  success: function(data){

				  
				  
			  }
			 
		 });	 
	}

	
	function my2(arr) {

		var out = "";
	    for(i = 0; i < arr.length; i++) {
	    	out +=  '<div class="list-group-item">' +
						'<a href="#" onclick="getPage(`' + arr[i].sectionId + '`)"  id="section' + arr[i].sectionId + '" ' + 
							'class="truncate" data-toggle="tooltip" data-placement="right" ' + 
							'title="' + arr[i].sectionName + '">&emsp;' + 
							(arr[i].sectionId - 10) + ' : ' + arr[i].sectionName + '</a></div>';
	   	}	    
	    $("#list-optional").html(out);
	}
	
	function my(arr, sid, asid, unlockarray) {

		console.log(unlockarray);
   		var out = "";
	    for(i = 0; i < arr.length; i++) {
	    	
	    	if((i+1) == sid) {
	    				
	    		out +=  '<a href="#" onclick="getPage(`' + arr[i].sectionId + '`)" id="section' + arr[i].sectionId + '" ' + 
							'class="btn btn-primary list-group-item truncate" role="button" ' + 
							'data-toggle="tooltip" data-placement="right" title="' + arr[i].sectionName + '">' + 
							'<span class="badge"></span><span class="glyphicon glyphicon-play-circle"></span>&emsp;' + arr[i].sectionName + ' ' + 
							" " + '</a>';
	    	}
	    	else if((i+1) < sid) {
	    		if((i+1) == asid) {
	    			out +=  '<a href="#" onclick="getPage(`' + arr[i].sectionId + '`)" id="section' + arr[i].sectionId + '" ' + 
								'class="btn btn-primary active list-group-item truncate" role="button" ' + 
			    				'data-toggle="tooltip" data-placement="right" title="' + arr[i].sectionName + '">' + 
			    				'<span class="badge"></span><span class="glyphicon glyphicon-ok"></span>&emsp;' + arr[i].sectionName + ' ' + 
			    				" " + '</a>';
	    		}
	    		else {
	    			out +=  '<a href="#" onclick="getPage(`' + arr[i].sectionId + '`)" id="section' + arr[i].sectionId + '" ' +
								'class="btn btn-success list-group-item truncate" style="color: green;" role="button" ' + 
								'data-toggle="tooltip" data-placement="right" title="' + arr[i].sectionName + '">' + 
								'<span class="badge"></span><span class="glyphicon glyphicon-ok"></span>&emsp;' + arr[i].sectionName + ' ' + 
								" " + '</a>';
	    		}
	    	}
				else if(unlockarray.indexOf(i+1)!=-1){
					    		
					    		out +=   '<a href="#" onclick="getPage(`' + arr[i].sectionId + '`)" id="section' + arr[i].sectionId + '" ' +
								'class="btn btn-success list-group-item truncate" style="color: green;" role="button" ' + 
								'data-toggle="tooltip" data-placement="right" title="' + arr[i].sectionName + '">' + 
								'<span class="badge"></span><span class="fa fa-unlock-alt"></span>&emsp; ' + arr[i].sectionName +
								" " + '</a>';
					    	}
	    	else {
	    		out +=  '<a href="#" onclick="getPage(`' + arr[i].sectionId + '`)" id="section' + arr[i].sectionId + '" ' +
							'class="btn btn-danger disabled list-group-item truncate" style="color: red;" role="button" ' + 
							'data-toggle="tooltip" data-placement="right" title="' + arr[i].sectionName + '">' + 
							'<span class="badge"></span><span class="glyphicon glyphicon-lock"></span>&emsp;' + arr[i].sectionName + ' ' + 
							" " + '</a>';
	    	}
	    }	    
	    $("#list-section").html(out);
	}
	
</script>

<ul class="nav nav-pills nav-stacked">
	<li id="dashboard"><a href="home3.jsp">&emsp;<i class="fa fa-home">&emsp;Home</i></a></li>
	<li id="section">
		<a id="col" role="button" data-toggle="collapse" data-parent="#accordion" 
			href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">&emsp;<i class="fa fa-tasks">&emsp;Essential Zone &emsp;</i><span class="caret"></span></a>
		<div id="collapseOne" class="collapse out" role="tabpanel" aria-labelledby="headingOne">
			<div class="list-group" id="list-section">
			</div>
		</div>
	</li>
	<li id="optional">
		<a id="col" role="button" data-toggle="collapse" data-parent="#accordion" 
			href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">&emsp;<i class="fa fa-tasks">&emsp;Optional Zone </i><span class="caret"></span></a>
		<div id="collapseTwo" class="collapse out" role="tabpanel" aria-labelledby="headingOne">
			<div class="list-group" id="list-optional">
			</div>
		</div>
	</li>
	<!-- <li id="optional"><a href="section3.jsp">&emsp;<i class="fa fa-tasks">&emsp;Optional Sections</i></a></li> -->
	<li id="workbook"><a href="workbook.jsp">&emsp;<i class="fa fa-tasks">&emsp;Workbook</i></a></li>
</ul>
<br>
<br>